---
title: "Basic SIR Model"
author: "Linh, Britney, Bowen"
output: html_notebook
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
library(mosaic)
library(ggplot2)
```

## Basic SIR Model

### Assumption
* The recovered (R) compartment will no longer be susceptible
* No treatment is given, disease ends due to herd immunity

### Parameters with default values:

* Population $(n = 500)$

* Transmission/Infection Rate $(\beta = 0.01)$

* Recovery Rate $(\gamma =  0.7)$

* Percentage of healthy individual that are susceptible $(S_{rate} = 0.2)$

* Initial number of infected individual $(I = 5)$

* Number of days since first case $(day = 50)$

```{r model.func}
basic.model = function(n = 500, beta = 0.01, gamma = 0.7, S.rate = 0.2, I = 5, day = -1){
  
  # Calculate day 0 statistics
  curr.day = 0
  healthy = n - I
  susceptible = round(S.rate * healthy)
  infected = I
  infected.next = round(I * beta * susceptible)
  treat = round(gamma * I)
  recovered = 0
  
  # Table storing S, I, R compartments over time
  df = data_frame(Day = curr.day, Healthy = healthy, Susceptible = susceptible, Infected = infected, Recovered = recovered)
  
  # Predict S, I, R compartments by day
  while(infected > 1){
    # if number of days is specified, calculate up until that day
    if(day != -1 & curr.day >= day)
       break()
    curr.day = curr.day + 1
    healthy = healthy - infected.next
    susceptible = round(S.rate * healthy)
    infected = infected + infected.next - treat
    infected.next = round(infected * beta * susceptible)
    treat = round(gamma * infected)
    recovered = recovered + treat
    data = c(curr.day, healthy, susceptible, infected, recovered)
    # data = c(curr.day, healthy, susceptible, infected, infected.next, treat, recovered)
    df = rbind(df, data)
  }
  return(df)
}
```

```{r plot_func}
model.plot = function(model){
  ggplot(data  = model, aes(x = Day)) +
    geom_line(aes(y = Healthy, color = "Healthy")) +
    geom_line(aes(y = Infected, color = "Infected")) +
    geom_line(aes(y = Recovered, color = "Recovered")) +
    scale_color_discrete(name = "Compartment") +
    labs(y = "Population", title = "Basic SIR Model") + 
    theme_minimal()
}
```

### 70% Recovery Rate

```{r 70model}
df = basic.model()
df
model.plot(df)
```

### 100% Recovery Rate

```{r 100model}
df = basic.model(gamma = 1)
model.plot(df)
```

### 75% Recovery Rate

```{r 75model}
df = basic.model(gamma = 0.75)
model.plot(df)
```

### 50% Recovery Rate

```{r 50model}
df = basic.model(gamma = 0.5)
model.plot(df)
```

### 25% Recovery Rate

```{r 25model}
df = basic.model(gamma = 0.25, day = 40)
model.plot(df)
```

### 0% Recovery Rate

```{r 0model}
df = basic.model(gamma = 0, day = 40)
model.plot(df)
```